import{d as Q,e as ee,b as te,r as M,c as T,s as x,k as s,y as ie,$ as E,A as le,z as ae,o as d,n as f,a as t,w as o,i as q,q as u,h as n,j as p,f as C,l as c,al as k,M as P,m as F}from"./index-b2a054f2.js";import{s as oe}from"./vue-virtual-scroller.esm-e4c9c0e9.js";/* empty css                             */import{_ as ne,f as ue,t as se}from"./utils-da036adc.js";import{V as G,a as de}from"./VTabs-8e6017ef.js";import{V as H}from"./VAlert-8fc0b4ef.js";import{V as g,a as $,d as re}from"./VCardText-db7c3153.js";import{V as J}from"./VTooltip-b4f86fd5.js";import{V as D,a as V}from"./VBtn-0977a48f.js";import{V as y}from"./VDivider-00712c8a.js";import{a as me}from"./VCard-abc5aa23.js";import{V as pe,b as W}from"./VToolbar-6c594292.js";import{V as _e}from"./forwardRefs-82423578.js";import{V as ve}from"./VDialog-37e53ec6.js";const fe={style:{"padding-left":"15px","padding-right":"-15px","padding-top":"10px","padding-bottom":"20px"}},ce=p("br",null,null,-1),ge={key:0},ye={class:"listitem-thumb"},be={key:0},qe={key:1},Ce={key:2},ke={class:"listitem-actions"},$e={key:0,class:"listitem-action"},Ve={key:1,class:"listitem-action"},he={key:2,class:"listitem-action"},Le=Q({__name:"PlayerQueue",setup(we){const{t:X}=ee(),B=te(),U=M(0),r=M(),I=M(!1),b=M([]),e=T(()=>{if(x.selectedPlayer)return s.queues[x.selectedPlayer.active_source]}),Y=T(()=>{if(e.value)return e.value.current_item}),N=T(()=>e.value?b.value.slice(e.value.current_index):[]),S=T(()=>e.value?b.value.slice(0,e.value.current_index):[]),Z=T(()=>U.value==1?S.value:N.value);ie(()=>{const i=s.subscribe_multi([E.QUEUE_UPDATED,E.QUEUE_ITEMS_UPDATED],l=>{var w;l.object_id==((w=e.value)==null?void 0:w.queue_id)&&(l.event==E.QUEUE_ITEMS_UPDATED?z():L())});le(i)});const z=async function(){e.value?(x.topBarTitle=e.value.display_name,b.value=[],await s.getPlayerQueueItems(e.value.queue_id,i=>{console.log("chunk",i.length),b.value.push(...i)})):(x.topBarTitle=void 0,b.value=[])},R=function(i){r.value=i,I.value=!0},j=function(i){A(),B.push({name:i.media_type,params:{itemId:i.item_id,provider:i.provider}})},h=function(i,l){A(),!(!i||!e.value)&&(l=="play_now"?s.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="move_next"?s.queueCommandMoveNext(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="up"?s.queueCommandMoveUp(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="down"?s.queueCommandMoveDown(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="delete"&&s.queueCommandDelete(e==null?void 0:e.value.queue_id,i.queue_item_id))},L=function(){x.topBarContextMenuItems=[{label:"settings.player_settings",labelArgs:[],action:()=>{B.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{s.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{s.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[X(`repeatmode.${e.value.repeat_mode}`)],action:()=>{s.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{s.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},A=function(){r.value=void 0,I.value=!1};return ae(()=>e.value,i=>{i&&(z(),L())},{immediate:!0}),(i,l)=>{var w;return d(),f("section",null,[t(de,{modelValue:U.value,"onUpdate:modelValue":l[0]||(l[0]=a=>U.value=a),"show-arrows":"",grow:""},{default:o(()=>[t(G,{value:0},{default:o(()=>[q(u(i.$t("queue_next_items")+" ("+n(N).length+")"),1)]),_:1}),t(G,{value:1},{default:o(()=>[q(u(i.$t("queue_previous_items")+" ("+n(S).length+")"),1)]),_:1})]),_:1},8,["modelValue"]),p("div",fe,[n(e)&&((w=n(e))==null?void 0:w.radio_source.length)>0?(d(),C(H,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:"",style:{"margin-right":"10px"}},{default:o(()=>{var a,v,m,_;return[p("b",null,u(i.$t("queue_radio_enabled")),1),ce,q(" "+u(i.$t("queue_radio_based_on",[i.$t((a=n(e))==null?void 0:a.radio_source[0].media_type)]))+" ",1),p("b",null,[p("a",{onClick:l[1]||(l[1]=K=>{var O;return n(e)?j((O=n(e))==null?void 0:O.radio_source[0]):""})},u((v=n(e))==null?void 0:v.radio_source[0].name),1)]),((m=n(e))==null?void 0:m.radio_source.length)>1?(d(),f("span",ge," (+"+u(((_=n(e))==null?void 0:_.radio_source.length)-1)+")",1)):c("",!0)]}),_:1})):c("",!0),t(n(oe),{items:n(Z),"item-size":66,"key-field":"queue_item_id","page-mode":""},{default:o(({item:a})=>{var v;return[p("div",null,[t(g,{ripple:"",disabled:a.queue_item_id==((v=n(Y))==null?void 0:v.queue_item_id),onClick:k(m=>R(a),["stop"]),onContextmenu:k(m=>R(a),["right","prevent"])},{prepend:o(()=>[p("div",ye,[t(ne,{item:a,width:"50px",height:"50px"},null,8,["item"])])]),title:o(()=>[q(u(a.media_item?a.media_item.name:a.name),1)]),subtitle:o(()=>[a.media_item&&"artists"in a.media_item&&a.media_item.artists.length>0?(d(),f("div",be,u(a.media_item.artists[0].name),1)):a.media_item?(d(),f("div",qe,u(a.media_item.metadata.description),1)):(d(),f("div",Ce,u(a.uri),1))]),append:o(()=>{var m;return[p("div",ke,[a.duration&&((m=a.media_item)==null?void 0:m.media_type)!=n(P).RADIO?(d(),f("div",$e,[p("span",null,u(n(ue)(a.duration)),1)])):c("",!0),i.$vuetify.display.mobile?c("",!0):(d(),f("div",Ve,[t(J,{location:"bottom"},{activator:o(({props:_})=>[t(D,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-up",onClick:[K=>n(s).queueCommandMoveUp(n(e).queue_id,a.queue_item_id),l[2]||(l[2]=k(()=>{},["prevent"])),l[3]||(l[3]=k(()=>{},["stop"]))]}),null,16,["onClick"])]),default:o(()=>[p("span",null,u(i.$t("queue_move_up")),1)]),_:2},1024)])),i.$vuetify.display.mobile?c("",!0):(d(),f("div",he,[t(J,{location:"bottom"},{activator:o(({props:_})=>[t(D,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-down",onClick:[K=>n(s).queueCommandMoveDown(n(e).queue_id,a.queue_item_id),l[4]||(l[4]=k(()=>{},["prevent"])),l[5]||(l[5]=k(()=>{},["stop"]))]}),null,16,["onClick"])]),default:o(()=>[p("span",null,u(i.$t("queue_move_down")),1)]),_:2},1024)]))])]}),_:2},1032,["disabled","onClick","onContextmenu"]),t(y)])]}),_:1},8,["items"]),b.value.length==0?(d(),C(H,{key:1,type:"info",style:{margin:"20px"}},{default:o(()=>[q(u(i.$t("no_content")),1)]),_:1})):c("",!0)]),t(ve,{modelValue:I.value,"onUpdate:modelValue":l[13]||(l[13]=a=>I.value=a),fullscreen:i.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:o(()=>[t(me,null,{default:o(()=>[t(pe,{sense:"",dark:"",color:"primary"},{default:o(()=>[t(D,{icon:"mdi-play-circle-outline"}),r.value?(d(),C(W,{key:0,style:{"padding-left":"10px"}},{default:o(()=>{var a;return[p("b",null,u(n(se)(((a=r.value)==null?void 0:a.name)||"",i.$vuetify.display.mobile?20:150)),1)]}),_:1})):(d(),C(W,{key:1,style:{"padding-left":"10px"}},{default:o(()=>{var a;return[p("b",null,u(i.$t("settings")),1),q(" | "+u((a=n(e))==null?void 0:a.display_name),1)]}),_:1})),t(D,{icon:"mdi-close",dark:"",text:"",onClick:l[6]||(l[6]=a=>A())})]),_:1}),r.value?(d(),C(re,{key:0},{default:o(()=>[t(_e,null,{default:o(()=>{var a,v;return[t(g,{title:i.$t("play_now"),onClick:l[7]||(l[7]=m=>h(r.value,"play_now"))},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("play_next"),onClick:l[8]||(l[8]=m=>h(r.value,"move_next"))},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_move_up"),onClick:l[9]||(l[9]=m=>h(r.value,"up"))},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_move_down"),onClick:l[10]||(l[10]=m=>h(r.value,"down"))},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_delete"),onClick:l[11]||(l[11]=m=>h(r.value,"delete"))},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(y),((v=(a=r.value)==null?void 0:a.media_item)==null?void 0:v.media_type)==n(P).TRACK?(d(),C(g,{key:0,title:i.$t("show_info"),onClick:l[12]||(l[12]=m=>{var _;return(_=r.value)!=null&&_.media_item?j(r.value.media_item):""})},{prepend:o(()=>[t($,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):c("",!0),t(y)]}),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});export{Le as default};
