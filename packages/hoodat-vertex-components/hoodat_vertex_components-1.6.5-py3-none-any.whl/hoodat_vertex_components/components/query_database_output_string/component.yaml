name: Query Database Output String
description: Query the hoodat database and output result as a string. Use this when your query returns a single cell.

inputs:
- {name: secret_sql_conn, type: String, default: "projects/176634837938/secrets/hoodat_db_connection_string/versions/latest", description: "The secret that contains the connection string for the database"}
- {name: query, type: String, default: "SELECT video_id FROM videos LIMIT 1", description: "Query to run against the database"}

outputs:
- {name: query_result, type: String, description: "The result of the query"}

implementation:
  container:
    image: europe-west1-docker.pkg.dev/hoodat-sandbox/hoodat-sandbox-kfp-components/query_database_output_string
    command:
    - sh
    - -c
    - |
      python src/query_db.py --secret_sql_conn "$0" --query "$1" --query_result "$2"
    args:
    - {inputValue: secret_sql_conn}
    - {inputValue: query}
    - {outputPath: query_result}
