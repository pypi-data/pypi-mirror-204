# Copyright 2022 Canonical
# See LICENSE file for licensing details.

[tox]
envlist =
    {py36,py37,py38}
    unit, lint
isolated_build = True
skip_missing_interpreters = True


[vars]
src_path = {toxinidir}/scenario
tst_path = {toxinidir}/tests


[testenv:unit]
description =  unit tests
deps =
    coverage[toml]
    pytest
    jsonpatch
commands =
    coverage run \
      --source={[vars]src_path} \
      -m pytest -v --tb native --log-cli-level=INFO -s {posargs} {[vars]tst_path}
    coverage report


[testenv:lint]
skip_install=True
description =  lint
deps =
    coverage[toml]
    pytest
    jsonpatch
    black
    isort
commands =
    black --check tests scenario
    isort --check-only --profile black tests scenario


[testenv:fmt]
skip_install=True
description = Format code
deps =
    black
    isort
commands =
    black tests scenario
    isort --profile black tests scenario
