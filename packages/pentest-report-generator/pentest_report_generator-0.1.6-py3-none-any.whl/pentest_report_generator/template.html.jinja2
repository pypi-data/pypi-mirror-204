<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="assets/pygmentize.css" />
  <link rel="stylesheet" href="assets/style.css" />
  <title>{{ title }}</title>
</head>

<body>
  {{ first_page }}
  <h2 class="toc-heading section-heading">Table of contents</h2>
  <div class="toc-wrapper">
    <ol class="ol-toc">
      <li>
        <a href="#disclaimer" class="toctext">Disclaimer</a>
        <a href="#disclaimer" class="tocpagenr"></a>
      </li>
      <li>
        <a href="#scope" class="toctext">Scope</a>
        <a href="#scope" class="tocpagenr"></a>
      </li>
      <li>
        <a href="#executive-summary" class="toctext">Executive summary</a>
        <a href="#executive-summary" class="tocpagenr"></a>
      </li>
        <li>
        <a href="#technical-summary" class="toctext">Technical summary</a>
        <a href="#technical-summary" class="tocpagenr"></a>
      </li>
      <li>
        <a href="#technical-details" class="toctext">Findings and technical details</a>
        <a href="#technical-details" class="tocpagenr"></a>
        <ol>
          <li>
            <a href="#methodology" class="toctext">Methodology</a>
            <a href="#methodology" class="tocpagenr"></a>
          </li>
          {% for vulngroup in [critical_high_vulnerabilities, medium_vulnerabilities, low_vulnerabilities,
          info_vulnerabilities] if (vulngroup.vulns|length) > 0 %}
          <li>
            <a href="{{'#' + vulngroup.vulns[0].severity_class}}" class="toctext">{{ vulngroup.title }} ({{
              vulngroup.vulns | length }})</a>
            <a href="{{'#' + vulngroup.vulns[0].severity_class}}" class="tocpagenr"></a>
            <ol>
              {% for vuln in vulngroup.vulns %}
              <li>
                <a href="{{ '#' + slugify(vuln.name) }}" class="tocvulntext1">{{ vuln.name }}</a>
                <a href="{{ '#' + slugify(vuln.name) }}" class="tocpagenr"></a>
              </li>
              {% endfor %}
            </ol>
          </li>
          {% endfor %}
        </ol>
      </li>
      {% for a in appendixes %}
          {% if loop.index == 1 %}
          {%- set className = namespace(value='appendix-start') %}
          {% else %}
          {%  set className = namespace(value='appendix-cont') %}
          {% endif %}

        <li class={{ className.value }} class="tocvulntext1">
            <a href="#{{  a.slug }}" class="tocvulntext1">{{ a.title }}</a>
            <a href="#{{ a.slug }}" class="tocpagenr"></a>
        </li>
    {% endfor %}
    </ol>
  </div>

  <h2 id="disclaimer" class="section-heading">Disclaimer</h2>
  {{ disclaimer }}

  <h2 id="scope" class="section-heading">Scope</h2>
  {{ scope }}

  <h2 id="executive-summary" class="section-heading">Executive summary</h2>
  {{ executive_summary }}

  <h2 id="technical-summary" class="section-heading">Technical summary</h2>
  {{ technical_summary }}

  <h2 id="technical-details" class="section-heading">Findings and technical details</h2>

  <h3 id="methodology">Methodology</h3>
  {{  methodology }}

  {% for vulngroup in [critical_high_vulnerabilities, medium_vulnerabilities, low_vulnerabilities,
  info_vulnerabilities] if (vulngroup.vulns|length) > 0 %}

  <h3 id="{{vulngroup.vulns[0].severity_class}}">{{ vulngroup.title }} ({{ vulngroup.vulns | length }})</h3>

  {% for vuln in vulngroup.vulns %}

  <h4 id="{{ slugify(vuln.name) }}" class="vuln-headline"><a style="text-decoration: none"
      href="{{ '#' + slugify(vuln.name) }}"></a>{{ vuln.name }}</h4>
  <table class="vuln-table">
    <tbody>
      <tr>
        <td class="table-header">Severity</td>
        <td>{{ vuln.severity }}</td>
      </tr>
      <tr>
        <td class="table-header">Impact</td>
        <td>{{ vuln.impact }}</td>
      </tr>
      <tr>
        <td class="table-header">Role</td>
        <td>{{ vuln.role }}</td>
      </tr>
    </tbody>
  </table>
  <h5>Location</h5>
  {{ vuln.location | join() }}
  <h5>Description</h5>
  {{ vuln.description | join() }}
  <h5>Steps to reproduce</h5>
  {{ vuln.evidence | join() }}
  <h5>Remediation</h5>
  {{ vuln.remedation | join() }}
  {% if vuln.references|length > 1 %}
      <h5>References</h5>
      {{ vuln.references | join() }}
  {% endif %}
  {% endfor %}
  {% endfor %}
  <div class="appendix-wrapper">
  {% for a in appendixes %}
      {{ a.html }}
  {% endfor %}
  </div>
</body>

</html>
