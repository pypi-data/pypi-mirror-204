@import "fonts.css";

:root {
    --color: black;
    --background-color: rgb(242, 242, 242);

    --spacing: 0.5cm;
}

html {
    font-family: 'Fira Sans', sans-serif;
}

body {
    margin: 0 auto; /* only for web view */
    max-width: 50rem; /* only for web view */
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}


h1, h2, h3, h4, h5, h6 {
    margin-top: var(--spacing);
    margin-bottom: var(--spacing);
    page-break-after: avoid;
}

/* counters */

h2 {
    counter-increment: h2;
    counter-reset: h3 h4;
}

#disclaimer {
    counter-reset: h2 h3 h4;
}

h2::before {
    content: counter(h2) "\a0\a0\a0\a0";
}

h3 {
    counter-increment: h3;
    counter-reset: h4;
}

h3::before {
    content: counter(h2) "." counter(h3) "\a0\a0\a0\a0"
}

h4 {
    counter-increment: h4;
}

h4::before {
    content: counter(h2) "." counter(h3) "." counter(h4) "\a0\a0\a0\a0";
}

.appendix-wrapper h2 {
    counter-increment: appendix-h2;
    counter-reset: appendix-h3 appendix-h4;
}
.appendix-wrapper h2::before {
    content: counter(appendix-h2, upper-alpha) "\a0\a0\a0\a0";
}

.appendix-wrapper h3 {
    counter-increment: appendix-h3;
    counter-reset: appendix-h4;
}
.appendix-wrapper h3::before {
    content: counter(appendix-h2, upper-alpha) "." counter(appendix-h3) "\a0\a0\a0\a0"
}

.appendix-wrapper h4 {
    counter-increment: appendix-h4;
}
.appendix-wrapper h4::before {
    content: counter(appendix-h2, upper-alpha) "." counter(appendix-h3) "." counter(appendix-h4) "\a0\a0\a0\a0"
}


/* end of counters */

.appendix-wrapper h3 {
    page-break-before: initial;
}

h2 {
    string-set: section content();
}

h1, h2, h3, h4 {
    font-weight: 500;
    page-break-before: always;
}

h2 + h3, h3 + h4 {
    page-break-before: initial;
}

h5, h6 {
    font-weight: 500;
    bookmark-level: none;
}

h1 {
    font-variant: small-caps;
}

h2 {
    page-break-before: always;
}

h3 {
    font-size: 1.5rem;
}

h4 {
    font-size: 1.3rem;
}

h5 {
    font-size: 1.1rem;
}

html {
    background-color: var(--background-color); /* only for weasyprint */
}

article {
    page-break-after: always;
}

.front-page {
    page-break-after: always;
}

a {
    color: var(--color);
    word-wrap: break-word;
}

.toc-wrapper >* a {
    color: var(--color);
    word-wrap: break-word;
    text-decoration: none;
}

ul, ol {
    /* list-style-position: inside; */
    margin-bottom: 1rem;
    margin-left: 1rem;
}

code {
    font-family: 'Fira Mono', monospace;
    word-wrap: break-word;
    white-space: pre-wrap;
    background-color: #e9e9e9;
}

pre {
    background-color: #e9e9e9;
    padding: 1rem;
    page-break-inside: avoid;
    line-height: 150%;
    font-family: 'Fira Mono', monospace;
}

.codehilite {
    margin: 1rem 0;
}

/* no margin after the heading for first code block */
h4 + .codehilite {
    margin-top: 0;
}

img {
    max-width: 100%;
    margin: 1rem 0;
}

li {
    margin-bottom: 1rem;
}

.vuln-table {
    width: 100%;
    border-spacing: 0;
    border-collapse: collapse;
    page-break-inside: avoid;
}

.follows-vuln-table + table {
    width: 100%;
    border-spacing: 0;
    border-collapse: collapse;
    page-break-inside: avoid;
    margin-bottom: 1rem;
}

.vuln-table td, .vuln-table th {
    padding: 0.25cm;
}

.follows-vuln-table + table td, 
.follows-vuln-table + table th {
    padding: 0.25cm;    
}

p {
    margin-bottom: 1rem;
}

blockquote {
    padding-left: 1cm;
    color: #4f4f4f;
}

td p {
    margin: 0;
}

td:has(.severity-critical) {
    background-color: red;
}

td:has(.severity-high) {
    background-color: #ff8800;
}

td:has(.severity-medium) {
    background-color: #fffb00;
}

td:has(.severity-low) {
    background-color: #ddff00;
}

td:has(.severity-none) {
    background-color: white;
}

tbody, td, th {
    border: 0.05cm solid rgb(110, 110, 110);
}

.table-header {
    /* cell wide enough just to fit content (one-liners only) */
    width: 0;
    white-space: nowrap;
    font-weight: 500;
}

.evidence-photo {
    display: block;
    margin: 0 auto;
}

.document-name {
    font-size: 2.5em;
    page: cover;
    padding-top: 3rem;
}

.toc-heading::before {
    content: "";
}

.toc-wrapper ol {
    counter-reset: item;
    list-style: none;
    margin-top: 1rem;
}

.toc-wrapper {
    font-weight: 500;
}

.toc-wrapper ol li ol li ol {
    counter-reset: item;
    font-weight: initial;
}

.toc-wrapper li::before {
    content: counters(item, ".") " ";
    counter-increment: item;
}

.tocpagenr {
    float: right;
}

.tocpagenr::after {
    content: target-counter(attr(href), page);
}

.methodology-section {
    page-break-after: always;
}

.toc-wrapper .skip::before {
    content: "\a0\a0\a0";
    counter-reset: item;
}

.toc-wrapper .appendix-start::before {
    counter-reset: item;
    content: "\a0\a0" counter(item, upper-latin);
}

/*.toc-wrapper .appendix-start ~ li::before {
    counter-reset: item 1; dirty, but works for a second appendix
    content: "\a0\a0" counter(item, upper-latin);
} */

.toc-wrapper .appendix-cont::before {
    counter-reset: item 1; /* dirty, but works for a second appendix */
    content: "\a0\a0" counter(item, upper-latin);
}


.tocvulntext1::before {
    /* content: target-text(attr(href)); */ /* works on weasy print, not on web */
}

.company-name {
    color: blue;
    display: inline-block;
    padding-top: 0.5rem;
}

.date {
    position: absolute;
    bottom: 0;
    right: 0;
}

.author-logo {
    width: 4rem;
}

.author-name {
    font-size: 1.5rem;
    display: inline-block;
}

.nochapter {
    page: plain;
}

.nochapter::before {
    content: "";
}


@media print {
    body {
        margin: 0;
        max-width: none;
        font-size: 14px;
    }

    h1, h2, h3, h4, h5, h6 {
    }

    h3 {
        font-size: 1.3rem;
    }

    h4 {
        font-size: 1.1rem;
    }

    h5 {
        font-size: 1rem;
    }

    .document-name {
        font-size: 3.5rem;
    }

    .toc-wrapper {
        padding-top: 1rem;
    }

    .author-section {
        position: absolute;
        bottom: 0;
        display: flex;
        align-items: center;
    }

}

@page {
    margin: 2cm; /* for browser-printing */
    background-color: var(--background-color); /* only for weasyprint */
    @bottom-right {
        content: counter(page);
    }

    @bottom-center {
        content: "CONFIDENTIAL";
        color: red;
        font-weight: bold;
    }
}

@page plain {
    @bottom-right {
        content: "";
    }
}

@page cover {
    @bottom-right {
        content: "";
    }
}
