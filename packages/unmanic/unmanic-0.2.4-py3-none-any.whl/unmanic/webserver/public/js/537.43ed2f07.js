"use strict";(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[537],{4919:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_e});var l=a(9835),n=a(6970);const s={class:"q-pa-none"},i={class:"row"},o={class:"col-sm-12 col-md-10 col-lg-8"},r={class:"q-mb-none"},c={class:"q-gutter-sm"},u={key:0,class:"text-weight-bold"},m=(0,l._)("br",null,null,-1),d={class:"text-weight-bold"},p={key:1},y={key:2},g=(0,l._)("br",null,null,-1),b={class:"text-weight-bold"},h={class:"text-weight-bold"},k={key:0},w={key:1},_={class:"text-weight-bold"},f={class:"row"},S={class:"col-6 text-left"},q={class:"row"},v={class:"col-6 text-left"},$={class:"text-grey-8 q-gutter-xs"},T={class:"q-mb-none"},L={class:"q-gutter-sm"},x={key:2,class:"sub-setting"},F={class:"q-gutter-sm"},O={class:"q-gutter-sm"},V={class:"q-gutter-sm"},P={class:"q-mb-none"},j={class:"q-gutter-sm"},C={class:"q-mb-none"},Q={class:"q-gutter-sm"},W={class:"q-mb-none"},z={class:"q-gutter-sm"},Z={key:2,class:"sub-setting"},U={class:"q-gutter-sm"},M={class:"q-gutter-sm"};function H(e,t,a,H,A,D){const I=(0,l.up)("q-skeleton"),R=(0,l.up)("q-avatar"),N=(0,l.up)("q-tooltip"),K=(0,l.up)("q-item-section"),E=(0,l.up)("q-item-label"),J=(0,l.up)("q-icon"),B=(0,l.up)("q-separator"),Y=(0,l.up)("q-btn"),G=(0,l.up)("q-item"),X=(0,l.up)("q-list"),ee=(0,l.up)("q-space"),te=(0,l.up)("q-bar"),ae=(0,l.up)("q-toggle"),le=(0,l.up)("q-input"),ne=(0,l.up)("q-slider"),se=(0,l.up)("q-form"),ie=(0,l.up)("MobileSettingsQuickNav"),oe=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(oe,{padding:""},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l._)("div",i,[(0,l._)("div",o,[(0,l._)("div",{class:(0,n.C_)(e.$q.platform.is.mobile?"q-ma-sm":"q-ma-sm q-pa-md")},[(0,l.Wm)(se,{onSubmit:D.save,class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l._)("h5",r,(0,n.zw)(e.$t("components.settings.library.pathConfiguration")),1),(0,l._)("div",c,[null===A.libraryPaths?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"text"})):(0,l.kq)("",!0),(0,l.Wm)(X,{bordered:"",separator:"",class:"rounded-borders"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(A.libraryPaths,((t,a)=>((0,l.wg)(),(0,l.j4)(G,{key:a,"active-class":"library-path-list-item"},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{"text-color":"grey-8",icon:"source"}),(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[0===a?((0,l.wg)(),(0,l.iD)("span",u,[(0,l.Uk)(" ("+(0,n.zw)(e.$t("components.settings.library.defaultLibrary"))+") ",1),m])):(0,l.kq)("",!0),(0,l._)("span",d,(0,n.zw)(e.$t("components.settings.library.path"))+":",1),t.enableRemoteOnly?((0,l.wg)(),(0,l.iD)("span",p," ("+(0,n.zw)(e.$t("components.settings.library.libraryRemoteOnlyStatus"))+") ",1)):((0,l.wg)(),(0,l.iD)("span",y,(0,n.zw)(t.path),1)),g,(0,l._)("span",b,(0,n.zw)(e.$t("components.settings.common.tags"))+":",1),(0,l.Uk)(" "+(0,n.zw)(t.tags.join(", ")||e.$t("status.none")),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(K,{class:"q-px-sm q-mx-sm"},{default:(0,l.w5)((()=>[0===a?((0,l.wg)(),(0,l.j4)(E,{key:0},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.name)+" * ",1),(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("tooltips.defaultLibrary")),1)])),_:1})])),_:2},1024)):((0,l.wg)(),(0,l.j4)(E,{key:1},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.name),1)])),_:2},1024)),(0,l.Wm)(E,{caption:"",lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("span",h,(0,n.zw)(e.$t("components.settings.library.path"))+": ",1),t.enableRemoteOnly?((0,l.wg)(),(0,l.iD)("span",k," ("+(0,n.zw)(e.$t("components.settings.library.libraryRemoteOnlyStatus"))+") ",1)):((0,l.wg)(),(0,l.iD)("span",w,(0,n.zw)(t.path),1))])),_:2},1024),(0,l.Wm)(E,{caption:"",lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("span",_,(0,n.zw)(e.$t("components.settings.common.tags"))+": ",1),(0,l.Uk)(" "+(0,n.zw)(t.tags.join(", ")||""),1)])),_:2},1024)])),_:2},1024),e.$q.platform.is.mobile?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(K,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(E,{lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("div",f,[(0,l._)("div",S,[(0,l._)("span",{class:(0,n.C_)(t.enableScanner&&!t.enableRemoteOnly?"text-primary":"text-grey-8")},[t.enableScanner&&!t.enableRemoteOnly?((0,l.wg)(),(0,l.j4)(J,{key:0,color:"check",name:"check"})):((0,l.wg)(),(0,l.j4)(J,{key:1,color:"close",name:"close"})),(0,l.Uk)(" | "+(0,n.zw)(e.$t("components.settings.library.libraryScannerStatusLabel")),1)],2)])])])),_:2},1024),(0,l.Wm)(E,{lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("div",q,[(0,l._)("div",v,[(0,l._)("span",{class:(0,n.C_)(t.enableInotify&&!t.enableRemoteOnly?"text-primary":"text-grey-8")},[t.enableInotify&&!t.enableRemoteOnly?((0,l.wg)(),(0,l.j4)(J,{key:0,color:"check",name:"check"})):((0,l.wg)(),(0,l.j4)(J,{key:1,color:"close",name:"close"})),(0,l.Uk)(" | "+(0,n.zw)(e.$t("components.settings.library.libraryFileMonitorStatusLabel")),1)],2)])])])),_:2},1024)])),_:2},1024)),(0,l.Wm)(B,{inset:"",vertical:"",class:"q-mx-sm"}),(0,l.Wm)(K,{center:"",side:""},{default:(0,l.w5)((()=>[(0,l._)("div",$,[(0,l.Wm)(Y,{flat:"",dense:"",round:"",size:"12px",color:"grey-8",icon:"tune",onClick:e=>D.configureLibraryPath(a)},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{class:"bg-white text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("tooltips.configure")),1)])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(Y,{flat:"",dense:"",round:"",size:"12px",color:"negative",icon:"delete",disable:t.locked,onClick:e=>D.deleteLibrary(a)},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{class:"bg-white text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("tooltips.delete")),1)])),_:1})])),_:2},1032,["disable","onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,l.Wm)(te,{class:"bg-transparent"},{default:(0,l.w5)((()=>[(0,l.Wm)(ee),(0,l.Wm)(Y,{round:"",flat:"",color:"primary",icon:"add",onClick:D.addNewLibraryWithDirectoryBrowser},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{class:"bg-white text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("tooltips.add")),1)])),_:1})])),_:1},8,["onClick"])])),_:1})]),(0,l.Wm)(B,{class:"q-my-lg"}),(0,l._)("h5",T,(0,n.zw)(e.$t("components.settings.library.libraryScanner")),1),(0,l._)("div",L,[null===A.enableLibraryScanner?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QToggle"})):((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.enableLibraryScanner,"onUpdate:modelValue":t[0]||(t[0]=e=>A.enableLibraryScanner=e),label:e.$t("components.settings.library.enableLibraryScanner")},null,8,["modelValue","label"])),A.enableLibraryScanner?((0,l.wg)(),(0,l.iD)("div",x,[(0,l._)("div",F,[null===A.libraryScanSchedule?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QInput"})):(0,l.kq)("",!0),A.enableLibraryScanner&&null!==A.libraryScanSchedule?((0,l.wg)(),(0,l.j4)(le,{key:1,outlined:"",type:"number",modelValue:A.libraryScanSchedule,"onUpdate:modelValue":t[1]||(t[1]=e=>A.libraryScanSchedule=e),label:e.$t("components.settings.library.libraryScannerSchedule"),"lazy-rules":"",rules:[t=>null!==t&&""!==t||e.$t("components.settings.library.libraryScannerScheduleNotValid"),t=>t>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,l.kq)("",!0)])])):(0,l.kq)("",!0)]),(0,l._)("div",O,[null===A.runLibraryScanOnStart?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QToggle"})):(0,l.kq)("",!0),null!==A.runLibraryScanOnStart?((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.runLibraryScanOnStart,"onUpdate:modelValue":t[2]||(t[2]=e=>A.runLibraryScanOnStart=e),label:e.$t("components.settings.library.runLibraryScanOnStart")},null,8,["modelValue","label"])):(0,l.kq)("",!0)]),(0,l._)("div",V,[null===A.libraryScanFollowSymlinks?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QToggle"})):(0,l.kq)("",!0),null!==A.libraryScanFollowSymlinks?((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.libraryScanFollowSymlinks,"onUpdate:modelValue":t[3]||(t[3]=e=>A.libraryScanFollowSymlinks=e),label:e.$t("components.settings.library.followSymlinks")},null,8,["modelValue","label"])):(0,l.kq)("",!0)]),(0,l.Wm)(B,{class:"q-my-lg"}),(0,l._)("h5",P,(0,n.zw)(e.$t("components.settings.library.fileTesting")),1),(0,l._)("div",j,[null===A.concurrentFileTesters?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QInput"})):(0,l.kq)("",!0),null!==A.concurrentFileTesters?((0,l.wg)(),(0,l.j4)(le,{key:1,readonly:"",outlined:"",color:"primary",modelValue:A.concurrentFileTesters,"onUpdate:modelValue":t[4]||(t[4]=e=>A.concurrentFileTesters=e),label:e.$t("components.settings.library.concurrentFileTesters"),placeholder:A.concurrentFileTesters},null,8,["modelValue","label","placeholder"])):(0,l.kq)("",!0),null===A.concurrentFileTesters?((0,l.wg)(),(0,l.j4)(I,{key:2,type:"QSlider"})):(0,l.kq)("",!0),null!==A.concurrentFileTesters?((0,l.wg)(),(0,l.j4)(ne,{key:3,modelValue:A.concurrentFileTesters,"onUpdate:modelValue":t[5]||(t[5]=e=>A.concurrentFileTesters=e),min:1,max:10,step:1,color:"primary"},null,8,["modelValue"])):(0,l.kq)("",!0)]),(0,l.Wm)(B,{class:"q-my-lg"}),(0,l._)("h5",C,(0,n.zw)(e.$t("components.settings.library.pendingTasks")),1),(0,l._)("div",Q,[null===A.clearPendingTasksOnStart?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QToggle"})):((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.clearPendingTasksOnStart,"onUpdate:modelValue":t[6]||(t[6]=e=>A.clearPendingTasksOnStart=e),label:e.$t("components.settings.library.clearPendingTasksOnStart")},null,8,["modelValue","label"]))]),(0,l.Wm)(B,{class:"q-my-lg"}),(0,l._)("h5",W,(0,n.zw)(e.$t("components.settings.library.completedTasks")),1),(0,l._)("div",z,[null===A.autoManageCompletedTasks?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QToggle"})):((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.autoManageCompletedTasks,"onUpdate:modelValue":t[7]||(t[7]=e=>A.autoManageCompletedTasks=e),label:e.$t("components.settings.library.autoManageCompletedTasks")},null,8,["modelValue","label"])),A.autoManageCompletedTasks?((0,l.wg)(),(0,l.iD)("div",Z,[(0,l._)("div",U,[null===A.maxAgeOfCompletedTasks?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QInput"})):(0,l.kq)("",!0),A.autoManageCompletedTasks&&null!==A.maxAgeOfCompletedTasks?((0,l.wg)(),(0,l.j4)(le,{key:1,outlined:"",type:"number",modelValue:A.maxAgeOfCompletedTasks,"onUpdate:modelValue":t[8]||(t[8]=e=>A.maxAgeOfCompletedTasks=e),label:e.$t("components.settings.library.maxAgeOfCompletedTasks"),"lazy-rules":"",rules:[t=>null!==t&&""!==t||e.$t("components.settings.pleaseEnterAValidNumber"),t=>t>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,l.kq)("",!0)]),(0,l._)("div",M,[null===A.alwaysKeepFailedTasks?((0,l.wg)(),(0,l.j4)(I,{key:0,type:"QInput"})):((0,l.wg)(),(0,l.j4)(ae,{key:1,modelValue:A.alwaysKeepFailedTasks,"onUpdate:modelValue":t[9]||(t[9]=e=>A.alwaysKeepFailedTasks=e),label:e.$t("components.settings.library.alwaysKeepFailedTasks")},null,8,["modelValue","label"]))])])):(0,l.kq)("",!0)]),(0,l._)("div",null,[(0,l.Wm)(Y,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])],2)])]),(0,l.Wm)(ie,{prevEnabled:!1,prevLabel:"none",prevPath:"/ui/settings-plugins",nextEnabled:!0,nextLabel:e.$t("navigation.workers"),nextPath:"/ui/settings-workers"},null,8,["nextLabel"])])])),_:1})}var A=a(586),D=a(499),I=a(9302),R=a(9991),N=a(9370),K=a(9981),E=a.n(K),J=a(6888),B=a(3754),Y=a(4227);const G={name:"SettingsLibrary",components:{MobileSettingsQuickNav:B.Z},setup(){(0,I.Z)();const{t:e}=(0,R.QT)();let t=null,a=(0,A.A)(e);function n(){t=a.init()}function s(){a.close()}(0,l.bv)((()=>{n()})),(0,l.Ah)((()=>{s()}))},data(){return{libraryPath:(0,D.iH)(null),libraryPaths:(0,D.iH)(null),newLibraryPath:(0,D.iH)(!1),enableLibraryScanner:(0,D.iH)(null),libraryScanSchedule:(0,D.iH)(null),libraryScanFollowSymlinks:(0,D.iH)(null),concurrentFileTesters:(0,D.iH)(null),runLibraryScanOnStart:(0,D.iH)(null),enableLibraryFileMonitor:(0,D.iH)(null),clearPendingTasksOnStart:(0,D.iH)(null),autoManageCompletedTasks:(0,D.iH)(null),maxAgeOfCompletedTasks:(0,D.iH)(null),alwaysKeepFailedTasks:(0,D.iH)(null)}},methods:{addNewLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:N.Z,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.libraryPath,listType:"directories"}}).onOk((e=>{if("undefined"!==typeof e.selectedPath&&null!==e.selectedPath){let t=(Math.random()+1).toString(36).substring(7),a="| "+(this.libraryPaths.length+1)+" | "+this.$t("components.settings.library.newLibrary")+" ("+t+")",l={library_config:{name:a,path:e.selectedPath}};E()({method:"post",url:(0,J.J4)("v2","settings/library/write"),data:l}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200}),this.fetchLibraryList()})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}})).onDismiss((()=>{}))},deleteLibrary:function(e){let t;for(let a=0;a<this.libraryPaths.length;a++)if(a===e){t=this.libraryPaths[a].id;break}1!==t?this.$q.dialog({title:this.$t("headers.confirm"),message:this.$t("components.settings.library.confirmRemove"),cancel:this.$t("navigation.cancel"),ok:this.$t("navigation.yes"),persistent:!0}).onOk((()=>{let e={id:t};E()({method:"delete",url:(0,J.J4)("v2","settings/library/remove"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200}),this.fetchLibraryList()})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))})):this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.cannotRemoveDefaultLibrary"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})},fetchSettings:function(){E()({method:"get",url:(0,J.J4)("v2","settings/read")}).then((e=>{this.libraryPath=e.data.settings.library_path,this.enableLibraryScanner=e.data.settings.enable_library_scanner,this.libraryScanSchedule=e.data.settings.schedule_full_scan_minutes,this.libraryScanFollowSymlinks=e.data.settings.follow_symlinks,this.concurrentFileTesters=e.data.settings.concurrent_file_testers,this.runLibraryScanOnStart=e.data.settings.run_full_scan_on_start,this.enableLibraryFileMonitor=e.data.settings.enable_inotify,this.clearPendingTasksOnStart=e.data.settings.clear_pending_tasks_on_restart,this.autoManageCompletedTasks=e.data.settings.auto_manage_completed_tasks,this.maxAgeOfCompletedTasks=e.data.settings.max_age_of_completed_tasks,this.alwaysKeepFailedTasks=e.data.settings.always_keep_failed_tasks})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e={settings:{library_path:this.libraryPath,enable_library_scanner:this.enableLibraryScanner,schedule_full_scan_minutes:this.libraryScanSchedule,follow_symlinks:this.libraryScanFollowSymlinks,concurrent_file_testers:this.concurrentFileTesters,run_full_scan_on_start:this.runLibraryScanOnStart,enable_inotify:this.enableLibraryFileMonitor,clear_pending_tasks_on_restart:this.clearPendingTasksOnStart,auto_manage_completed_tasks:this.autoManageCompletedTasks,max_age_of_completed_tasks:this.maxAgeOfCompletedTasks,always_keep_failed_tasks:this.alwaysKeepFailedTasks}};E()({method:"post",url:(0,J.J4)("v2","settings/write"),data:e}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},fetchLibraryList:function(){E()({method:"get",url:(0,J.J4)("v2","settings/libraries")}).then((e=>{let t=[];for(let a=0;a<e.data.libraries.length;a++){let l=e.data.libraries[a];t[t.length]={id:l.id,name:l.name,path:l.path,enableRemoteOnly:l.enable_remote_only,enableScanner:l.enable_scanner,enableInotify:l.enable_inotify,tags:l.tags,locked:l.locked}}this.libraryPaths=t})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchLibraryList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},configureLibraryPath:function(e){let t=this.libraryPaths[e];this.$q.dialog({component:Y.Z,componentProps:{header:this.$t("headers.configureLibrary"),componentName:"LibraryConfigForm",componentProps:{libraryId:t.id}}}).onOk((e=>{})).onDismiss((()=>{this.fetchSettings(),this.fetchLibraryList()}))}},created(){this.fetchSettings(),this.fetchLibraryList()}};var X=a(1639),ee=a(9885),te=a(8326),ae=a(7133),le=a(3246),ne=a(490),se=a(1233),ie=a(1357),oe=a(6858),re=a(3115),ce=a(2857),ue=a(926),me=a(8879),de=a(4526),pe=a(136),ye=a(3175),ge=a(6611),be=a(8423),he=a(9984),ke=a.n(he);const we=(0,X.Z)(G,[["render",H]]),_e=we;ke()(G,"components",{QPage:ee.Z,QForm:te.Z,QSkeleton:ae.ZP,QList:le.Z,QItem:ne.Z,QItemSection:se.Z,QAvatar:ie.Z,QTooltip:oe.Z,QItemLabel:re.Z,QIcon:ce.Z,QSeparator:ue.Z,QBtn:me.Z,QBar:de.Z,QSpace:pe.Z,QToggle:ye.Z,QInput:ge.Z,QSlider:be.Z})}}]);