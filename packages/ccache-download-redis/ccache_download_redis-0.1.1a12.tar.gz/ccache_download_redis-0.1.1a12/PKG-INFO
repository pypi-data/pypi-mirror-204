Metadata-Version: 2.1
Name: ccache-download-redis
Version: 0.1.1a12
Summary: A script to downloads the contents of the local ccache cache from a Redis remote storage.
Home-page: https://github.com/berlin4apk/action-ccache-download-upload-redis
License: GPL-3.0-or-later
Keywords: ccache,redis,download
Author: berlin4apk
Author-email: 83521068+berlin4apk@users.noreply.github.com
Requires-Python: >=3.9,<4.0
Classifier: License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Requires-Dist: humanize (>=4.6.0,<5.0.0)
Requires-Dist: progress (>=1.6,<2.0)
Requires-Dist: progress-bar (>=8,<9)
Requires-Dist: redis (>=4.5.4,<5.0.0)
Project-URL: Repository, https://github.com/berlin4apk/action-ccache-download-upload-redis
Description-Content-Type: text/markdown

# ccache-upload-redis / ccache-download-redis GitHub Action

An GitHub Action for using ccache-upload-redis / ccache-download-redis
to uploads / downloads the contents of the local ccache cache from a Redis remote storage.

## Usage

- 
- 


```yaml
name: Test ccache-download-upload-redis
on:
  workflow_dispatch:
jobs:
  # Label of the container job
  container-job:
    # Containers must run in Linux based operating systems
    runs-on: ubuntu-latest
    # Service containers to run with `container-job`
    services:
      # Label used to access the service container
      redis:
        # Docker Hub image
        image: redis:7.0.10-alpine3.17
        # Set health checks to wait until redis has started
        options: >-
          --interactive
          --hostname redis
          --add-host=host.docker.internal:host-gateway
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
          --restart always
        ports:
          - 6379/tcp
          # get the rendom port via ${{ job.services.redis.ports['6379'] }}
          # https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idservices
          # https://docs.github.com/en/actions/learn-github-actions/contexts#job-context
          # Maps port 6379 on service container to the host
          #- 6379:6379

    steps:
      - name: "Set some redis settings"
        run: |
          docker network ls
          docker network ls --format='{{.ID }} {{.Name}}'
          docker inspect ${{ job.services.redis.id }}
          docker exec ${{ job.services.redis.id }} /bin/sh -c 'echo "cat /etc/redis/redis.conf ||:" '
          docker exec ${{ job.services.redis.id }} /bin/sh -x -c 'mkdir -p /etc/redis ||: '
          docker exec ${{ job.services.redis.id }} /bin/sh -x -c 'echo "save 60 100" >> /etc/redis/redis.conf'
          docker exec ${{ job.services.redis.id }} /bin/sh -x -c 'echo "loglevel verbose" >> /etc/redis/redis.conf'
          docker exec ${{ job.services.redis.id }} /bin/sh -x -c 'echo "# see https://github.community/t/how-do-i-properly-override-a-service-entrypoint/17435/8" >> /etc/redis/redis.conf'
          docker exec ${{ job.services.redis.id }} /bin/sh -x -c 'echo "# https://hub.docker.com/_/redis" >> /etc/redis/redis.conf'
          docker kill --signal=SIGHUP ${{ job.services.redis-y9g98g58d.id }} ||:

      - name: Checkout repository
        uses: actions/checkout@v3

      - upload-test: "upload-test"
        run: |
          ccache-upload-redis
        env: |
          REDIS_CONF='localhost:${{ job.services.redis.ports['6379'] }}'
          CCACHE_DIR='~/.cache/ccache'
          
      - download-test: "download-test"
        run: |
          ccache-download-redis
        env: |
          REDIS_CONF='localhost:${{ job.services.redis.ports['6379'] }}'
          CCACHE_DIR='~/.cache/ccache'

      - name: Connect REDIS
        uses: ./
        with:
          host: ${{ variable.REDIS_SERVER }}
          username: ${{ variable.USERNAME }}
          password: ${{ variable.PASSWORD }}
          ccachedir: ${{ variable.CCACHEDIR }}


